/* Shared Theme (source of truth). Copied into each app's public/css/theme.css by entrypoint.sh */
:root {
    --color-bg: #0d0f11;
    --color-bg-alt: #161b22;
    --color-bg-soft: #1f252d;
    --color-surface: #222b35;
    --color-surface-alt: #23272f;
    --color-border: #2d3742;
    --color-border-strong: #3a4754;
    --color-text: #f5f7fa;
    --color-text-dim: #96a2b3;
    --color-accent: #ff9800;
    --color-accent-glow: #ffb84d;
    --color-success: #2ecc71;
    --color-danger: #ff3b30;
    --color-warning: #ffcc00;
    --color-info: #007bff;
    --color-info-alt: #00a8ff;
    --color-success-strong: #28a745;
    --color-success-hover: #218838;
    --color-danger-strong: #dc3545;
    --color-danger-hover: #c82333;
    --color-danger-soft: #ff4757;
    --color-surface-inset: #181c24;
    --color-surface-muted: #2a2e35;
    --color-mid-disabled: #555;
    --color-text-disabled: #888;
    --gradient-accent: linear-gradient(90deg, var(--color-accent) 0%, var(--color-accent-glow) 100%);
    --gradient-accent-rev: linear-gradient(90deg, var(--color-accent-glow) 0%, var(--color-accent) 100%);
    --gradient-surface: linear-gradient(145deg, #1c232b, #14191f);
    --gradient-info: linear-gradient(90deg, var(--color-info) 0%, var(--color-info-alt) 100%);
    --gradient-info-rev: linear-gradient(90deg, var(--color-info-alt) 0%, var(--color-info) 100%);
    --gradient-download: linear-gradient(90deg, #43e97b 0%, #38f9d7 100%);
    --gradient-download-rev: linear-gradient(90deg, #38f9d7 0%, #43e97b 100%);
    --gradient-success: linear-gradient(90deg, #2ecc71 0%, #43e97b 100%);
    --radius-xs: 4px;
    --radius-sm: 6px;
    --radius-md: 10px;
    --radius-lg: 18px;
    --radius-pill: 999px;
    --shadow-sm: 0 2px 4px -1px rgba(0, 0, 0, .4), 0 1px 2px rgba(0, 0, 0, .4);
    --shadow-md: 0 4px 10px -2px rgba(0, 0, 0, .45), 0 2px 4px -1px rgba(0, 0, 0, .4);
    --shadow-lg: 0 8px 28px -4px rgba(0, 0, 0, .55);
    --shadow-accent-glow: 0 4px 16px 0 rgba(255, 184, 77, .35);
    --shadow-focus-soft: 0 0 0 2px #ffb84d33;
    --color-focus-ring: 0 0 0 3px rgba(255, 152, 0, 0.4);
    --font-stack: system-ui, -apple-system, 'Segoe UI', Roboto, Ubuntu, Cantarell, 'Noto Sans', 'Helvetica Neue', Arial, sans-serif;
    --layout-max-width: 960px;
    --nav-height: 62px;
    --topbar-height: 56px;
    --box-max-width: 720px;
    --color-panel-bg: rgba(30, 32, 38, 0.97);
    --color-panel-border-dashed: var(--color-accent-glow);
    --color-dropzone-bg: var(--color-surface-alt);
    --color-input-bg: #181c24;
    --color-input-border: #333;
    --border-width-dashed: 2.5px;
    --border-dashed-accent: var(--border-width-dashed) dashed var(--color-accent-glow);

    /* Shared sizing and spacing tokens */
    --font-size-xs: .65rem;
    --font-size-sm: .75rem;
    --font-size-base: .9rem;
    --font-size-md: 1rem;
    --font-size-lg: 1.2rem;
    --gap-xs: .25rem;
    --gap-sm: .4rem;
    --gap-md: .65rem;
    --gap-lg: 1rem;
    --bar-height: var(--topbar-height, 56px);
    --bottom-nav-height: var(--bar-height);
}

/* utilities */
.text-accent {
    color: var(--color-accent-glow) !important
}

.bg-surface {
    background: var(--color-surface)
}

.bg-panel {
    background: var(--color-panel-bg)
}

.btn-accent {
    background: var(--gradient-accent);
    color: #23272f
}

.btn-accent:hover {
    background: var(--gradient-accent-rev);
    color: #fff
}

.text-dim {
    color: var(--color-text-dim) !important
}

.text-danger {
    color: var(--color-danger) !important
}

.text-success {
    color: var(--color-success) !important
}

.text-warning {
    color: var(--color-warning) !important
}

.text-info {
    color: var(--color-info) !important
}

.m-0 {
    margin: 0 !important
}

.mt-1 {
    margin-top: .25rem !important
}

.mt-2 {
    margin-top: .5rem !important
}

.mt-3 {
    margin-top: 1rem !important
}

.mt-4 {
    margin-top: 1.5rem !important
}

.mb-1 {
    margin-bottom: .25rem !important
}

.mb-2 {
    margin-bottom: .5rem !important
}

.mb-3 {
    margin-bottom: 1rem !important
}

.mb-4 {
    margin-bottom: 1.5rem !important
}

.mx-auto {
    margin-left: auto !important;
    margin-right: auto !important
}

.flex-center {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important
}

.shadow-sm {
    box-shadow: var(--shadow-sm) !important
}

.shadow-md {
    box-shadow: var(--shadow-md) !important
}

.shadow-lg {
    box-shadow: var(--shadow-lg) !important
}

@media (prefers-color-scheme: light) {
    :root {
        --color-bg: #f7f9fb;
        --color-bg-alt: #eef1f5;
        --color-bg-soft: #e4e9ef;
        --color-surface: #ffffff;
        --color-surface-alt: #ffffff;
        --color-border: #d5dbe3;
        --color-border-strong: #b8c2ce;
        --color-text: #1b232b;
        --color-text-dim: #5a6675;
        --color-accent: #cc6a00;
        --color-accent-glow: #ff9e2b;
        --color-panel-bg: #ffffff;
        --color-dropzone-bg: #f2f5f8;
        --color-input-bg: #f2f5f8;
        --color-input-border: #c7d0db;
        --shadow-sm: 0 2px 4px -1px rgba(0, 0, 0, .08), 0 1px 2px rgba(0, 0, 0, .06);
        --shadow-md: 0 4px 12px -2px rgba(0, 0, 0, .10), 0 2px 4px -1px rgba(0, 0, 0, .08);
        --shadow-lg: 0 8px 28px -4px rgba(0, 0, 0, .12);
        --shadow-accent-glow: 0 4px 16px 0 rgba(255, 158, 43, .25);
        --color-focus-ring: 0 0 0 3px rgba(204, 106, 0, .35)
    }
}

.btn-info {
    background: var(--gradient-info);
    color: #fff
}

.btn-info:hover {
    background: var(--gradient-info-rev)
}

.btn-download {
    background: var(--gradient-download);
    color: #23272f
}

.btn-download:hover {
    background: var(--gradient-download-rev);
    color: #fff
}

.btn-success-solid {
    background: var(--color-success-strong);
    color: #fff
}

.btn-success-solid:hover {
    background: var(--color-success-hover)
}

.btn-danger-solid {
    background: var(--color-danger-strong);
    color: #fff
}

.btn-danger-solid:hover {
    background: var(--color-danger-hover)
}

.border-dashed-accent {
    border: var(--border-dashed-accent)
}

.shadow-accent-glow {
    box-shadow: var(--shadow-accent-glow)
}

.theme-toggle {
    display: inline-flex;
    align-items: center;
    gap: .5rem
}

.theme-toggle-btn {
    background: var(--gradient-accent);
    border: none;
    color: #23272f;
    width: 40px;
    height: 40px;
    border-radius: var(--radius-pill);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1.05rem;
    box-shadow: var(--shadow-sm);
    transition: background .25s, transform .25s
}

.theme-toggle-btn:hover {
    background: var(--gradient-accent-rev)
}

.theme-toggle-btn:active {
    transform: scale(.9)
}

.theme-toggle-btn:focus {
    outline: none;
    box-shadow: var(--color-focus-ring)
}

/* Core shared layout components */
/* Top bar and sections */
.page-wrapper { padding-top: var(--topbar-height); padding-bottom: var(--bottom-nav-height); min-height: calc(100vh - var(--bottom-nav-height)); }
.app-topbar { position: fixed; top: 0; left: 0; right: 0; height: var(--bar-height, 56px); display: flex; align-items: center; gap: 1rem; padding: 0 .85rem; background: rgba(13,15,17,0.72); backdrop-filter: blur(18px) saturate(180%); -webkit-backdrop-filter: blur(18px) saturate(180%); border-bottom: 1px solid var(--color-border); z-index: 50; }
.app-logo { font-size: 1.05rem; font-weight: 600; background: var(--gradient-accent); -webkit-background-clip: text; background-clip: text; color: transparent; text-decoration: none; display: inline-flex; align-items: center; flex: 1 1 0; }
.app-topbar-center { flex: 1 1 0; display: flex; justify-content: center; }
.app-topbar-right { flex: 1 1 0; display: flex; align-items: center; justify-content: flex-end; gap: var(--gap-md); }

/* Bottom navigation */
.bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; height: var(--bottom-nav-height); background: rgba(13,15,17,0.82); backdrop-filter: blur(18px) saturate(180%); -webkit-backdrop-filter: blur(18px) saturate(180%); border-top: 1px solid var(--color-border); z-index: 60; display: flex; }
.bottom-nav ul { list-style: none; margin: 0; padding: 0; display: flex; width: 100%; justify-content: space-around; align-items: center; }
.bottom-nav a { display: flex; flex-direction: column; align-items: center; justify-content: center; gap: .25rem; font-size: var(--font-size-xs); color: var(--color-text-dim); text-decoration: none; position: relative; height: 100%; padding: .2rem .4rem; letter-spacing: .3px; transition: color .25s; }
.bottom-nav a i { font-size: 1.05rem; }
.bottom-nav a.active, .bottom-nav a:hover { color: var(--color-accent); }
/* Active underline removed as requested */

/* Light/dark explicit surfaces for header and bottom nav */
:root[data-theme='light'] .app-topbar,
:root[data-theme='light'] .bottom-nav { background: #ffffff; backdrop-filter: none; -webkit-backdrop-filter: none; }
:root[data-theme='dark'] .app-topbar { background: rgba(13,15,17,0.72); }
:root[data-theme='dark'] .bottom-nav { background: rgba(13,15,17,0.82); }

/* Toast / notification system */
.toast-root { position: fixed; top: calc(var(--topbar-height) + .75rem); right: .85rem; display: flex; flex-direction: column; gap: .65rem; z-index: 120; width: min(340px, calc(100vw - 1.5rem)); pointer-events: none; }
.toast { --_bg: var(--color-surface); --_border: var(--color-border); --_accent: var(--color-accent); display: flex; align-items: flex-start; gap: .75rem; background: var(--_bg); color: var(--color-text); border: 1px solid var(--_border); border-left: 4px solid var(--_accent); padding: .85rem .95rem .85rem .95rem; border-radius: var(--radius-md); box-shadow: var(--shadow-lg); font-size: var(--font-size-sm); line-height: 1.3; position: relative; overflow: hidden; isolation: isolate; pointer-events: auto; animation: toast-in .45s cubic-bezier(.4,0,.2,1); }
.toast.toast-info { --_accent: var(--color-info); }
.toast.toast-success { --_accent: var(--color-success); }
.toast.toast-warn { --_accent: var(--color-warning); }
.toast.toast-error { --_accent: var(--color-danger); }
.toast h4 { margin: 0 0 .2rem 0; font-size: var(--font-size-sm); font-weight: 600; letter-spacing: .3px; }
.toast .toast-body { flex: 1; text-align: left; }
.toast button.toast-close { position: absolute; top: .35rem; right: .35rem; background: none; border: none; color: var(--color-text-dim); cursor: pointer; padding: .35rem; line-height: 1; font-size: .85rem; border-radius: var(--radius-sm); }
.toast button.toast-close:hover { color: var(--color-text); background: var(--color-surface-alt); }
.toast-progress { position: absolute; left: 0; bottom: 0; height: 3px; background: var(--_accent); width: 100%; transform-origin: left; animation: toast-progress linear forwards; }
@keyframes toast-in { from { opacity: 0; transform: translateY(-6px) scale(.97);} to { opacity: 1; transform: translateY(0) scale(1);} }
@keyframes toast-out { to { opacity: 0; transform: translateY(-6px) scale(.97);} }
@keyframes toast-progress { from { transform: scaleX(1);} to { transform: scaleX(0);} }
@media (max-width:600px){ .toast-root { top: auto; bottom: calc(var(--bottom-nav-height) + .75rem); right: .75rem; left: .75rem; width: auto; } }

/* Shared form controls */
.ui-select { appearance: none; -webkit-appearance: none; background: var(--color-surface); color: var(--color-text); border: 1px solid var(--color-border); padding: .45rem .8rem; border-radius: var(--radius-pill); font-size: var(--font-size-sm); line-height: 1.2; box-shadow: var(--shadow-sm); cursor: pointer; transition: background .25s, border .25s, box-shadow .25s; }
.ui-select:focus { outline: none; border-color: var(--color-accent); box-shadow: 0 0 0 2px #ffb84d33; }
.ui-select:hover { background: var(--color-surface-alt); }
:root[data-theme='light'] .ui-select { background: #ffffff; }

:root[data-theme='light'] {
    --color-bg: #f7f9fb;
    --color-bg-alt: #eef1f5;
    --color-bg-soft: #e4e9ef;
    --color-surface: #ffffff;
    --color-surface-alt: #ffffff;
    --color-border: #d5dbe3;
    --color-border-strong: #b8c2ce;
    --color-text: #1b232b;
    --color-text-dim: #5a6675;
    --color-accent: #cc6a00;
    --color-accent-glow: #ff9e2b;
    --color-panel-bg: #ffffff;
    --color-dropzone-bg: #f2f5f8;
    --color-input-bg: #f2f5f8;
    --color-input-border: #c7d0db;
    --shadow-sm: 0 2px 4px -1px rgba(0, 0, 0, .08), 0 1px 2px rgba(0, 0, 0, .06);
    --shadow-md: 0 4px 12px -2px rgba(0, 0, 0, .10), 0 2px 4px -1px rgba(0, 0, 0, .08);
    --shadow-lg: 0 8px 28px -4px rgba(0, 0, 0, .12);
    --shadow-accent-glow: 0 4px 16px 0 rgba(255, 158, 43, .25);
    --color-focus-ring: 0 0 0 3px rgba(204, 106, 0, .35)
}

:root[data-theme='dark'] {
    --color-bg: #0d0f11;
    --color-bg-alt: #161b22;
    --color-bg-soft: #1f252d;
    --color-surface: #222b35;
    --color-surface-alt: #23272f;
    --color-border: #2d3742;
    --color-border-strong: #3a4754;
    --color-text: #f5f7fa;
    --color-text-dim: #96a2b3;
    --color-panel-bg: rgba(30, 32, 38, 0.97);
    --color-dropzone-bg: var(--color-surface-alt);
    --color-input-bg: #181c24;
    --color-input-border: #333;
    --shadow-sm: 0 2px 4px -1px rgba(0, 0, 0, .4), 0 1px 2px rgba(0, 0, 0, .4);
    --shadow-md: 0 4px 10px -2px rgba(0, 0, 0, .45), 0 2px 4px -1px rgba(0, 0, 0, .4);
    --shadow-lg: 0 8px 28px -4px rgba(0, 0, 0, .55);
    --shadow-accent-glow: 0 4px 16px 0 rgba(255, 184, 77, .35)
}

/* Shared card grid for Saved/Search/Library */
.results-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: var(--gap-lg); padding: 1rem 0; }
.video-item { display:flex; flex-direction:column; gap:.5rem; padding:.6rem; border:1px solid var(--color-border); border-radius: var(--radius-md); background: var(--color-surface); text-align:center; box-shadow: var(--shadow-sm); }
.video-thumbnail { border-radius: var(--radius-sm); overflow:hidden; }
.video-thumbnail img { width:100%; height:140px; object-fit: cover; display:block; transition: transform .2s ease; }
.video-thumbnail:hover img { transform: scale(1.03); }
.video-item p { margin:.35rem 0 .15rem; font-weight:600; font-size: var(--font-size-sm); color: var(--color-text); }
.video-item small { color: var(--color-text-dim); font-size: var(--font-size-xs); }
.video-item button { margin-top:6px; padding:.4rem .65rem; background: var(--gradient-info); color:#fff; border:none; border-radius: var(--radius-sm); cursor:pointer; font-size: var(--font-size-xs); box-shadow: var(--shadow-sm); }
.video-item button:hover { background: var(--gradient-info-rev); }
.video-item button + button { background: var(--color-danger-strong); }
.video-item button + button:hover { background: var(--color-danger-hover); }
/* Variant: ensure full media is visible (no cropping) inside preview */
.media-contain img, .media-contain video { height:160px; object-fit: contain; background:#000; }
@media (max-width: 480px){ .video-thumbnail img, .media-contain img, .media-contain video { height: 140px; } }
/* Mobile grid: force 2 columns for Saved/Library */
@media (max-width: 600px){
    .results-grid { grid-template-columns: repeat(2, 1fr) !important; }
}

/* Shared inline media overlay (used by Saved/Library) */
.media-overlay { --overlay-gap: .75rem; position: fixed; inset: 0; z-index: 160; background: rgba(0,0,0,0.86); display: none; align-items: center; justify-content: center; padding: calc(var(--topbar-height) + var(--overlay-gap)) var(--overlay-gap) calc(var(--bottom-nav-height) + var(--overlay-gap)); }
.media-overlay.open { display: flex; }
.media-overlay .media-frame { position: relative; width: min(96vw, 1100px); height: min(74vh, calc(100vh - var(--topbar-height) - var(--bottom-nav-height) - 2rem)); display:flex; align-items:center; justify-content:center; }
.media-overlay .media-frame img, .media-overlay .media-frame video { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: var(--radius-md); box-shadow: var(--shadow-2xl, 0 10px 40px rgba(0,0,0,.6)); background: #000; }
.media-overlay .close-btn { position: absolute; top: var(--overlay-gap); right: var(--overlay-gap); width: 42px; height: 42px; border-radius: 999px; border: 1px solid var(--color-border); background: rgba(30,32,38,0.85); color: var(--color-text); display:flex; align-items:center; justify-content:center; cursor:pointer; box-shadow: var(--shadow-md); }
:root[data-theme='light'] .media-overlay .close-btn { background: rgba(255,255,255,0.92); }
.media-overlay .nav-btn { position:absolute; top:50%; transform: translateY(-50%); width:48px; height:48px; border-radius:999px; border:1px solid var(--color-border); background: rgba(30,32,38,0.8); color: var(--color-text); display:flex; align-items:center; justify-content:center; cursor:pointer; box-shadow: var(--shadow-md); font-size: 1.2rem; }
.media-overlay .prev-btn { left: .75rem; }
.media-overlay .next-btn { right: .75rem; }
.media-overlay .nav-btn:disabled { opacity: .45; cursor: default; }
/* On mobile, place navigation buttons below the media instead of overlaying it */
@media (max-width: 600px) {
    .media-overlay.open {
        display: grid;
        grid-template-columns: auto auto;
        grid-template-rows: 1fr auto;
        justify-content: center;
        justify-items: center;
        align-content: stretch;
        align-items: center;
        column-gap: var(--overlay-gap);
        row-gap: var(--overlay-gap);
        padding-bottom: calc(var(--bottom-nav-height) + var(--overlay-gap) + env(safe-area-inset-bottom, 0px));
        padding-left: calc(var(--overlay-gap) + env(safe-area-inset-left, 0px));
        padding-right: calc(var(--overlay-gap) + env(safe-area-inset-right, 0px));
    }
    .media-overlay .media-frame { grid-column: 1 / -1; grid-row: 1; }
    .media-overlay .nav-btn { position: static; transform: none; margin-top: 0; width: 44px; height: 44px; }
    .media-overlay .prev-btn { grid-column: 1; grid-row: 2; justify-self: end; }
    .media-overlay .next-btn { grid-column: 2; grid-row: 2; justify-self: start; }
}

/* Utility to disable background scroll when overlays are open */
html.no-scroll, body.no-scroll { overflow: hidden !important; }

/* Floating media controls (shared) */
.floating-controls { position: absolute; right: .85rem; bottom: .85rem; z-index: 130; display: flex; flex-direction: column; gap: .6rem; opacity: 0; transform: translateY(8px); transition: opacity .25s cubic-bezier(.4,0,.2,1), transform .25s cubic-bezier(.4,0,.2,1); }
.floating-controls.visible { opacity: 1; transform: translateY(0); }
.floating-controls.hidden { opacity: 0; transform: translateY(8px); }
.float-btn { width: 44px; height: 44px; border-radius: 999px; border: 1px solid var(--color-border); background: rgba(30,32,38,0.82); backdrop-filter: blur(10px) saturate(140%); -webkit-backdrop-filter: blur(10px) saturate(140%); color: var(--color-text); box-shadow: var(--shadow-md); display: inline-flex; align-items: center; justify-content: center; cursor: pointer; }
:root[data-theme='light'] .float-btn { background: rgba(255,255,255,0.86); }
.float-btn:hover { filter: brightness(1.08); }
.float-btn i { font-size: 1rem; }
.float-btn--save[aria-pressed="true"] i { color: var(--color-accent, #ff9800); }
@media (max-width: 420px) {
    .floating-controls { 
        right: calc(env(safe-area-inset-right, 0px) + .65rem); 
        bottom: calc(env(safe-area-inset-bottom, 0px) + .65rem); 
    }
}
.float-panel { position: absolute; right: 56px; bottom: 0; min-width: 180px; padding: .7rem .75rem; border-radius: var(--radius-md); border: 1px solid var(--color-border); background: rgba(30,32,38,0.9); backdrop-filter: blur(10px) saturate(140%); -webkit-backdrop-filter: blur(10px) saturate(140%); color: var(--color-text); box-shadow: var(--shadow-lg); }
:root[data-theme='light'] .float-panel { background: rgba(255,255,255,0.92); }
.float-panel .float-panel-row { font-size: .85rem; margin-bottom: .4rem; }
.float-panel .ap-range { width: 100%; }